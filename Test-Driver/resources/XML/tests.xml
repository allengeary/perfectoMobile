<?xml version="1.0" encoding="UTF-8"?>
<suite xmlns="http://www.morelandlabs.com/testRegistry" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.morelandlabs.com/testRegistry https://github.com/allengeary/xsd/raw/master/morelandLabs/pageManagement/testRegistry.xsd">
	<model>
      <page name="Search" />
   </model>
   
   <test name="forceFail" dataProvider="searchCriteria" dataDriver="perfectoResults" active="false">
      <step name="SEARCH" page="Search" type="WAIT_FOR" />
      <step name="RESULTS" page="Search" type="EXISTS" />
   </test>
   
   <test name="tokenSearch" dataProvider="searchCriteria" dataDriver="perfectoResults" active="false">
      <step name="SEARCH" page="Search" type="WAIT_FOR" />
      <step name="SEARCH" page="Search" type="SET">
         <parameter type="DATA" value="searchCriteria.criteria" />
      </step>
      <step name="SEARCH_BUTTON" page="Search" type="CLICK" />
      <step name="RESULTS" page="Search" type="WAIT_FOR" />
      
      <step name="TOKEN_RESULT" page="Search" type="CLICK" >
         <token type="data" name="perfectoData" value="perfectoResults.criteria" />
      </step>
      <step name="WAIT" type="WAIT" />

   </test>
   
   <test name="tokenLoop" dataProvider="searchCriteria,perfectoResults" active="false">
      <step name="SEARCH" page="Search" type="WAIT_FOR" />
      <step name="SEARCH" page="Search" type="SET">
         <parameter type="DATA" value="searchCriteria.criteria" />
      </step>
      <step name="SEARCH_BUTTON" page="Search" type="CLICK" />
      <step name="RESULTS" page="Search" type="WAIT_FOR" />
      
      <step type="LOOP" page="Search" name="loopOverResult">
          <parameter type="static" value="data{perfectoResults}" />
          <parameter type="static" value="checkText" />
      </step>
      
      <step name="TOKEN_RESULT" page="Search" type="CLICK" >
         <token type="data" name="perfectoData" value="perfectoResults.criteria" />
      </step>
      <step name="WAIT" type="WAIT" />

   </test>
   
   <function name="checkText">
      <step name="TOKEN_RESULT" page="Search" type="EXISTS" >
         <token type="data" name="perfectoData" value="perfectoResults.criteria" />
      </step>
   </function>
   
   <test name="searchOne" dataProvider="searchCriteria" active="false">
      <step name="SEARCH" page="Search" type="WAIT_FOR" />
      <step name="SEARCH" page="Search" type="SET">
         <parameter type="DATA" value="searchCriteria.criteria" />
      </step>
      <step name="SEARCH_BUTTON" page="Search" type="CLICK" />
      <step name="RESULTS" page="Search" type="EXISTS" />
      
      
      
      <step type="LOOP" page="Search" name="checkResults">
          <parameter type="static" value="3" />
          <parameter type="static" value="scrollDown" />
      </step>
      
      <step name="WAIT" type="WAIT" />
      
      <step type="LOOP" page="Search" name="checkResults">
          <parameter type="static" value="RESULTS" />
          <parameter type="static" value="viewResult" />
      </step>
      
      <step name="WAIT" type="WAIT" />
      
      <!--  <step name="WAIT" type="WAIT" />
      
      <step type="FORK" page="Search" name="choosePath">
          <parameter type="static" value="SEARCH2" />
          <parameter type="static" value="SEARCH3" />
          <parameter type="static" value="SEARCH" />
          <step name="RESULTS" page="Search" type="EXISTS" />
          <step name="RESULTS" page="Search" type="EXISTS" />
          <step name="viewResult" page="Search" type="CALL" />
      </step>
      
      <step type="LOOP" page="Search" name="checkResults">
          <parameter type="static" value="RESULTS" />
          <parameter type="static" value="viewResult" />
      </step>  -->
   </test>
   
   <test name="searchTwo" dataDriver="searchCriteria" active="false">
      <step name="SEARCH" page="Search" type="WAIT_FOR" />
      <step name="SEARCH" page="Search" type="SET">
         <parameter type="DATA" value="searchCriteria.criteria" />
      </step>
      <step name="SEARCH_BUTTON" page="Search" type="CLICK" />
      <step name="RESULTS" page="Search" type="EXISTS" />
      
      
      
      <step name="WAIT" type="WAIT" />
      
      <!-- <step type="FORK" page="Search" name="choosePath">
          <parameter type="static" value="SEARCH2" />
          <parameter type="static" value="SEARCH3" />
          <parameter type="static" value="SEARCH" />
          <step name="RESULTS" page="Search" type="EXISTS" />
          <step name="RESULTS" page="Search" type="EXISTS" />
          <step name="viewResult" page="Search" type="CALL" />
      </step> -->
      
      <step type="LOOP" page="Search" name="checkResults">
          <parameter type="static" value="RESULTS" />
          <parameter type="static" value="viewResult" />
      </step>
   </test>
   
   <function name="scrollDown">
      <step name="SWIPE" page="Search" type="GESTURE" >
         <parameter type="static" value="UP" />
      </step>
      <step name="CRUNCH" page="Search" type="EXISTS"  failureMode="IGNORE" >
         <step name="crunchFound" page="Search" type="BREAK" />
      </step>
      
   </function>
   
   <function name="viewResult">
      <step name="_CONTEXT.ELEMENT" page="Search" type="EXISTS" />
      <step name="_CONTEXT.ELEMENT-->RESULT_HEADER" page="Search" type="EXISTS" failureMode="IGNORE" >
         <step name="_CONTEXT.ELEMENT-->RESULT_HEADER" page="Search" type="CLICK" />
         <step name="elementFound" page="Search" type="BREAK" />
      </step>
   </function>
</suite>